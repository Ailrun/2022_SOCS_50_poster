\documentclass[25pt,a0paper,portrait,dvipsnames,innermargin=0.4in,colspace=0.4in,blockverticalspace=0.4in]{tikzposter}

\usepackage{amssymb}
\usepackage{libertine}
\usepackage{listings}

\definecolor{ProfessionalGreen}{RGB}{0, 104, 106}
\definecolor{ProfessionalDarkGreen}{RGB}{0, 33, 34}

\definecolorstyle{MyPoster}{
  \definecolor{colorOne}{named}{ProfessionalGreen}
  \definecolor{colorTwo}{named}{RedOrange}
  \definecolor{colorThree}{named}{RoyalBlue}
}{
  % Background Colors
  \colorlet{backgroundcolor}{white}
  \colorlet{framecolor}{black}
  % Title Colors
  \colorlet{titlefgcolor}{colorOne!5!white}
  \colorlet{titlebgcolor}{colorOne}
  % Block Colors
  \colorlet{blocktitlebgcolor}{ProfessionalDarkGreen}
  \colorlet{blocktitlefgcolor}{ProfessionalDarkGreen!10!white}
  \colorlet{blockbodybgcolor}{ProfessionalDarkGreen}
  \colorlet{blockbodyfgcolor}{ProfessionalDarkGreen!10!white}
  % Innerblock Colors
  \colorlet{innerblocktitlebgcolor}{white}
  \colorlet{innerblocktitlefgcolor}{black}
  \colorlet{innerblockbodybgcolor}{colorThree!30!white}
  \colorlet{innerblockbodyfgcolor}{black}
  % Note colors
  \colorlet{notefgcolor}{black}
  \colorlet{notebgcolor}{colorTwo!50!white}
  \colorlet{noteframecolor}{colorTwo}
}
\settitle{\vbox{
  \hspace*{2in}
  \colorbox{white}{\hbox to 4in {\vbox to 4in {\vspace*{1.6in} \raisebox{-0.5\height}{\@titlegraphic}}}}
  \hspace*{-6.8in}
  \vbox{
    % \@titlegraphic\\[\TP@titlegraphictotitledistance]
    \raggedleft
    \vspace*{0.5in}
    \color{titlefgcolor} {\bfseries \Huge \sc \@title \hspace*{0.5in} \par}
    \vspace*{1in}
    \vbox{
      {\LARGE \@author \par} \vspace*{0.2in} {\large https://Ailrun.github.io \par} \vspace*{0.3in} {\large \@institute}
    }
    \vspace*{-0.2in}
  }
}}

\defineblockstyle{MyBlock}{
  titlewidthscale=1, bodywidthscale=1, titleleft,
  titleoffsetx=0in, titleoffsety=0in, bodyoffsetx=0in, bodyoffsety=0.6in,
  bodyverticalshift=0.6in, roundedcorners=2, linewidth=5pt,
  titleinnersep=0.3in, bodyinnersep=0.3in
}{
  \begin{scope}[line width=\blocklinewidth, rounded corners=\blockroundedcorners]
    \ifBlockHasTitle %
      \draw[color=blocktitlebgcolor, fill=blocktitlebgcolor] (blockbody.south west) rectangle (blocktitle.north east);
      \draw[color=blocktitlebgcolor, fill=blockbodybgcolor] (blockbody.south west) rectangle (blockbody.north east);
      \draw[color=blocktitlefgcolor, thin] ($(blocktitle.south west) + (1em,0)$) -- ($(blocktitle.south east) + (-1em, 0)$);
    \else
      \draw[color=blocktitlebgcolor, fill=blockbodybgcolor] (blockbody.south west) rectangle (blockbody.north east);
    \fi
  \end{scope}
}

% \usetheme{Autumn}
\usetitlestyle[titletoblockverticalspace=0.5in,innersep=0in,linewidth=0in]{Filled}
\usecolorstyle{MyPoster}
\useblockstyle[roundedcorners=2]{MyBlock}

\newenvironment{tikzfigure*}[1][]{
  \def \rememberparameter{#1}
  \vspace{10pt}
  \begin{center}
  }{
    \ifx\rememberparameter\@empty
    \else %nothing
    \vspace{10pt}
    {\small \rememberparameter}
    \fi
  \end{center}
}

\lstdefinelanguage{Moebius}%
{%
  keywords=%
  {%
    box,with,%
    Fun,fun,%
    if,else,then,match,%
    let,in,%
    case,of,%
    type,%
  },%
  sensitive,
  morecomment=[l]{--},%
  moredelim=[is][\color{orange}]{o<<}{>>o},%
  moredelim=[is][\color{violet}]{v<<}{>>v},%
  moredelim=[is][\color{ForestGreen}]{fg<<}{>>fg},%
  moredelim=[is][\color{NavyBlue}]{nb<<}{>>nb},%
  moredelim=[is][\color{WildStrawberry}]{ws<<}{>>ws},%
  moredelim=[is][\color{white}]{w<<}{>>w},%
}
% \lstset{%
%   basicstyle=\ttfamily\footnotesize,%
%   keywordstyle=\color{blue}\bfseries,%
%   numberstyle=\ttfamily\bfseries\color{gray}\footnotesize,%
%   literate=%
%   {->}{{\(\rightarrow\ \)}}2 %
%   {|-}{{\(\vdash\)}}2 %
%   {\\alpha}{{\(\alpha\)}}1 %
%   {\\beta}{{\(\beta\)}}1 %
%   {\\tau}{{\(\tau\)}}1 %
%   {\\sigma}{{\(\sigma\)}}1 %
%   {\\rho}{{\(\rho\)}}1 %
%   {\\Gamma}{{\(\Gamma\)}}1 %
%   {\\Psi}{{\(\Psi\)}}1 %
%   {[}{{\(\lceil\)}}1 % box
%   {]}{{\(\rceil\)}}1 % box
%   {u<}{{\(\lfloor\)}}1 % unbox
%   {>u}{{\(\rfloor\)}}1 % unbox
%   {v[}{[}1 % list
%   {]v}{]}1 % list
%   ,%
%   mathescape=true,%
%   xleftmargin=0.05in,%
%   resetmargins=true,%
%   belowskip=0.05in,%
%   aboveskip=0.05in,%
% }
\lstset{
  basicstyle=\color{black!5!white}\ttfamily,%
  keywordstyle=\color{orange},%
  xleftmargin=1in,%
  xrightmargin=1in,%
  framextopmargin=0.5in,%
  framexbottommargin=0.5in,%
  framexleftmargin=0.5in,%
  framexrightmargin=0.5in,%
  framesep=0in,%
  frame=single,%
  framerule=0in,%
  backgroundcolor=\color{black},%
  mathescape=true,
  literate=%
  {\\Box}{{\(\Box\)}}1 %
  ,%
}
\lstloadlanguages{Moebius}
\lstset{language=Moebius}

\newcommand\moeb[1]{\colorbox{black}{\lstinline[flexiblecolumns=false]{#1}}}

\begin{filecontents*}[overwrite]{src/untyped-nth.premoebius}
ws<<nth>>ws n =
  if n <= 0 then
    box(nb<<head xs>>nb)
  else
    let box(C) = ws<<nth>>ws (n - 1) in
    box(nb<<let xs = tail xs in>>nb C)
\end{filecontents*}

\begin{filecontents*}[overwrite]{src/int-nth.moebius}
ws<<nth>>ws : fg<<Int -> \Box (Int list -> Int)>>fg
ws<<nth>>ws n =
  if n <= 0 then
    box(nb<<fun xs => head Int xs>>nb)
  else
    let box(C) = nth (n - 1) in
    box(nb<<fun xs =>>>nb C nb<<(tail Int xs)>>nb)
\end{filecontents*}

\begin{filecontents*}[overwrite]{src/polymorphic-nth-wrong.moebius}
ws<<nth>>ws : fg<<(a' : Type) -> Int -> \Box ('a list -> 'a)>>fg
ws<<nth>>ws a' n =
  if n <= 0 then
    box(nb<<fun xs => head a' xs>>nb)
  else
    let box(C) = nth a' (n - 1) in
    box(nb<<fun xs =>>>nb C nb<<(tail a' xs)>>nb)
\end{filecontents*}

\begin{document}
\title{Type System for Metaprogramming}
\author{Junyoung ``Clare'' Jang}
\date{\today}
\institute{Complogic Group}
\titlegraphic{\includegraphics[width=4in]{./mcgill_sig_red.png}}
%% Abstract:
%% Metaprogramming is the art of generating, manipulating, and analyzing code. This technique is nearly universal: compilers, user libraries, and program analyzers use this technique for both better performance and easier maintenance. However, metaprogramming has been suffered from one issue: it is harder to write a reliable and safe metaprogram, especially because they are harder to test thoroughly. This poster will present how to give static reliability and safety guarantees using a type system on metaprograms, illustrated with issues in a type system for metaprogramming and our solutions.
\maketitle{}

\begin{columns}
  \column{0.5}
  \block{Metaprogramming}{
    The art of generating, manipulating, and analyzing code\\
    \mbox{}\hfill\(\longleftarrow{}\) Compiler,Program Analyzer,Program generator,etc.\\
    \begin{tikzfigure*}
      \begin{tikzpicture}
        \draw (0,2) node {\moeb{box(nb<<2 + 3>>nb)}} (20,2) node {A code fragment for code \moeb{nb<<2 + 3>>nb}};
        \draw (0,0) node {\moeb{let box(C) = box(nb<<2 + 3>>nb) in C}} (20,0) node {Execution of \moeb{C} to get \moeb{5}};
      \end{tikzpicture}
    \end{tikzfigure*}
    \begin{tikzfigure*}[Untyped Metaprogram to get nth item in a list with no type/scope checking]
      \lstinputlisting{src/untyped-nth.premoebius}
    \end{tikzfigure*}
    Some text text text text text text text text text text text text text text text text text text text text text text text text text text text text text}

  \block{\emph{Typed} Metaprogramming}{
    Some text text text text text text text text text text text text text text text text text text text text text text text text text text text
    \begin{tikzfigure*}[Typed Metaprogram to get nth item in an int list]
      \lstinputlisting{src/int-nth.moebius}
    \end{tikzfigure*}
    Some text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text}

  \block{Problem 1 \---- Well-typed Open Code Fragments}{Some text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text}

  \block{Problem 2 \---- Polymorphism}{Some text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text
    \begin{tikzfigure*}[Ill-typed Metaprogram to get nth item in a list]
      \lstinputlisting{src/polymorphic-nth-wrong.moebius}
    \end{tikzfigure*}
    Some text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text}

  \block{Problem 3 \---- Pattern Matching on Code Fragments}{Some text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text}

  \column{0.5}
  % Judgment - explanation form
  % Rule - explanation form
  % Connection between ``necessity'' and ``code fragment''
  \block{Modal Logic}{Some text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text}

  \block{Contextual Modality}{Some text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text}

  \block{Levels (Opt)}{Some text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text}

  \block{Levels in Polymorphism}{Some text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text}

  \block{Levels in Pattern Matching}{Some text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text}

  \block{References}{Some text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text text}
\end{columns}
\end{document}
